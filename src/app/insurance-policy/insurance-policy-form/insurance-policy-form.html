<div class="form-container">
  <form [formGroup]="rxform" (ngSubmit)="onSubmit()" class="livestock-form">
    <mat-card>
      <mat-card-header>
        <mat-card-title>Livestock Information</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <!-- Row 1: Tag Number, Species, Breed -->

        <!-- Animal Photos Section -->
        <!-- Policy Document Section -->
        <div class="form-row animal-photos-section">
          <label class="section-label">Policy Document</label>

          <!-- Preview -->
          <div *ngIf="previewPhoto" class="photos-container">
            <div class="animal-photos-preview">
              <div class="photo-card" (click)="openPreviewInNewTab()">
                <ng-container [ngSwitch]="fileType">
                  <!-- Image preview -->
                  <img *ngSwitchCase="'image'" [src]="previewPhoto" alt="Document preview" class="animal-photo" />

                  <!-- PDF or DOC placeholder -->
                  <div *ngSwitchCase="'pdf'" class="file-preview">📄 PDF Document</div>
                  <div *ngSwitchCase="'doc'" class="file-preview">📝 Word Document</div>
                  <div *ngSwitchDefault class="file-preview">📁 Document Preview</div>
                </ng-container>
              </div>
            </div>
          </div>

          <!-- Upload Button -->
          <label for="policyDocument" class="upload-btn">
            <span>Upload Policy Document</span>
            <input id="policyDocument" type="file" (change)="onFilesSelected($event)" hidden />
          </label>
        </div>


        <div class="form-row">
          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Group Name</mat-label>
            <input matInput formControlName="policyNumber" type="text" />
            <mat-error *ngIf="policyNumber.hasError('required')">Policy Number is required.</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Provider</mat-label>
            <input matInput formControlName="provider" type="text" />
            <mat-error *ngIf="provider.hasError('required')">Provider is required.</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Livestock Group</mat-label>
            <mat-select formControlName="livestockGroup">
              <mat-option *ngFor="let g of livestockGroups" [value]="g._id">
                {{ g.groupName }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="livestockGroup.hasError('required')">
              Livestock Group is required.
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Row 3: Farmer, Livestock Group -->
        <div class="form-row">
          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Farmer</mat-label>
            <mat-select formControlName="farmer">
              <mat-option *ngFor="let f of farmers" [value]="f.id">{{ f.name }}</mat-option>
            </mat-select>
            <mat-error *ngIf="farmer.hasError('required')">Farmer is required.</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option value="pending">Pending</mat-option>
              <mat-option value="approved">Approved</mat-option>
              <mat-option value="rejected">Rejected</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="third-width">
            <mat-label>Start Date</mat-label>
            <input matInput formControlName="startDate" type="date" />
            <mat-error *ngIf="startDate.hasError('required')">
              Start Date is required.
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="outline" class="third-width">
            <mat-label>End Date</mat-label>
            <input matInput formControlName="endDate" type="date" />
            <mat-error *ngIf="startDate.hasError('required')">
              End Date is required.
            </mat-error>
          </mat-form-field>
        </div>

        
      </mat-card-content>

      <mat-card-actions align="end">
        <button mat-raised-button color="primary" type="submit" [disabled]="rxform.invalid || isLoading">Submit</button>
      </mat-card-actions>
    </mat-card>
  </form>
</div>
